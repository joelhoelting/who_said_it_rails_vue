# in your script.sh  set variables with export variable_name="value"
#[ec2-user@ip-172-31-7-22 ~]$ printenv |grep "test"^C
#    [ec2-user@ip-172-31-7-22 ~]$ export test="123"
#   [ec2-user@ip-172-31-7-22 ~]$ printenv |grep "test"
#   test=123
    

Parameters:
  bucket: 
    Type: CommaDelimitedList
    Description: "Name of the Amazon S3 bucket that contains your file"
    Default: "elasticbeanstalk-us-east-1-139673441925" #### replace
  fileuri: 
    Type: String
    Description: "Path to the file in S3"
    Default: "https://s3-region.amazonaws.com/elasticbeanstalk-us-east-1-139673441925/who_said_it_env_vars.sh"  #### replace
  authrole:
    Type: String
    Description: "Role with permissions to download the file from Amazon S3"
    Default: "aws-elasticbeanstalk-ec2-role"   #### replace

#### Replace the path "/home/ec2-user/myfile.txt" with the path where you want to put the file.

files:
  /home/ec2-user/who_said_it_env_vars.sh:
    mode: "000777"
    owner: ec2-user
    group: ec2-user
    source: { "Ref" : "fileuri" }
    authentication: S3AccessCred

commands:
  01setenv:
    command: chmod +x who_said_it_env_vars.sh
    cwd: /home/ec2-user/
  02setenv:
    command: ./who_said_it_env_vars.sh
    cwd: /home/ec2-user/

#### Do not modify values below this line ####

Resources:
  AWSEBAutoScalingGroup:
    Type: "AWS::AutoScaling::AutoScalingGroup"
    Metadata:
      AWS::CloudFormation::Authentication:
        S3AccessCred:
          type: "S3"
          roleName: { "Ref" : "authrole" } 
          buckets: { "Ref" : "bucket" }

